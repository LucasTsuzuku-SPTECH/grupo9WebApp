<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Zephyrus | Cadastro Hospital</title>

    <script src="./js/sessao.js"></script>

    <link rel="stylesheet" href="../css/forms.css" />
    <link rel="stylesheet" href="./../css/dashboards.css">
    <link rel="icon" href="../assets/imgs/Zephyrus_2png.png" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<main id="formulario-main">
    <div class="esquerda">
        <div class="imagem-lateral">
            <img src="../assets/imgs/fundoLogin.jpg" />
        </div>
    </div>
    <div class="direita">
        <div class="voltarCadastro">
            <a href="contas.html">
                <span>Voltar</span>
                <i class="fa-solid fa-arrow-right"></i>
            </a>
        </div>
        <div class="formulario-login">
            <div class="logo">
                <h1>Zephyrus</h1>
            </div>
            <div class="formulario">
                <div class="formulario-principal">
                    <!-- Hospital -->
                    <div class="campo">
                        <label for="">Nome do Hospital</label>
                        <input type="text" id="nome_input" placeholder="Nome do Hospital*" class="ipt_digitar" />
                    </div>
                    <div class="campo">
                        <label for="">CNPJ</label>
                        <input type="text" id="cnpj_input" placeholder="00.000.000/0000-00" class="ipt_digitar" />
                    </div>
                    <!-- Endereço -->
                    <div class="campo">
                        <label for="">CEP</label>
                        <input type="text" id="cep_input" placeholder="00000-000" class="ipt_digitar" />
                    </div>
                    <div class="juntar">
                        <div class="campo">
                            <label for="">Cidade</label>
                            <input type="text" id="cidade_input" placeholder="São Paulo"
                                class="ipt_digitar caixa_maior" />
                        </div>
                        <div class="campo">
                            <label for="">UF</label>
                            <input type="text" id="estado_input" placeholder="SP" class="ipt_digitar caixa_menor">
                        </div>
                    </div>
                    <div class="campo">
                        <label for="">Bairro</label>
                        <input type="text" id="bairro_input" placeholder="Guaianases" class="ipt_digitar">
                    </div>
                    <div class="juntar">
                        <div class="campo">
                            <label for="">Logradouro</label>
                            <input type="text" id="logradouro_input" placeholder="Rua jardim das flores"
                                class="ipt_digitar caixa_maior">
                        </div>
                        <div class="campo">
                            <label for="">Número</label>
                            <input type="text" id="numero_input" placeholder="34" class="ipt_digitar caixa_menor">
                        </div>
                    </div>

                    <button onclick="cadastrar()">Entrar</button>



                </div>
                <div class="nao-cliente">
                </div>
            </div>
        </div>
    </div>

</main>
</body>

</html>



<script>
    const perfilSelect = document.getElementById("perfil");
    const hospitalLabel = document.getElementById("labelHospital");
    const hospitalInput = document.getElementById("hospital_input");

    perfilSelect.addEventListener("change", () => {
        if (perfilSelect.value === "Hospital") {
            hospitalLabel.style.display = "block";
            hospitalInput.style.display = "block";
        } else {
            hospitalLabel.style.display = "none";
            hospitalInput.style.display = "none";
        }
    });

    function cadastrar() {
        var emailVar = email_input.value;
        var nomeVar = nome_input.value;
        var senhaVar = senha_input.value;
        var confirmarSenha = confirmacao_senha_input.value;

        let hospitalVar = "";
        if (perfilSelect.value === "Hospital") {
            hospitalVar = hospitalInput.value;
        }

        if (confirmarSenha != senhaVar) {
            alert("As senhas não coincidem");
            return;
        } else {
            if (nomeVar == "" || emailVar == "" || senhaVar == "") {
                finalizarAguardar();
                return false;
            }

            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    nomeServer: nomeVar,
                    emailServer: emailVar,
                    senhaServer: senhaVar,
                    perfilServer: perfilSelect.value,
                    fkEmpresaServer: 1,
                    fkHospitalServer: 1
                }),
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {
                        setTimeout(() => {
                            window.location = "login.html";
                        }, "2000");
                        finalizarAguardar();
                    } else {
                        throw "Houve um erro ao tentar realizar o cadastro!";
                    }
                });
        }
    }


</script>